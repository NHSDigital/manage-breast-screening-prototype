{# app/views/_includes/medical-information/breast-features.njk #}

{% set rawBreastFeatures = event.medicalInformation.breastFeaturesRaw | parseJsonString %}
{% set breastFeatures = event.medicalInformation.breastFeatures or rawBreastFeatures %}
{% set breastFeaturesCount = breastFeatures | length %}
{% set hasBreastFeatures = breastFeaturesCount > 0 %}

{% if hasBreastFeatures %}

  <p>
    {{ breastFeaturesCount }} breast {{ "feature" | pluralise(breastFeaturesCount) }} recorded
  </p>

  <script>
  window.breastFeaturesConfig = {
    readOnly: true,
    existingFeatures: {{ breastFeatures | dump | safe }} || []
  }
  </script>
  <script src="/js/breast-features.js"></script>

  {# div with hardcoded max-width, left aligned #}
  <div class="nhsuk-grid-row nhsuk-u-margin-bottom-3">
    {# column two thirds column one third #}
    <div class="nhsuk-grid-column-two-thirds">
      {% include "breast-diagram.njk" %}
    </div>
    <div class="nhsuk-grid-column-one-third">
      {% set suppressClearLink = true %}
      {% include "features-list.njk" %}
    </div>
  </div>

  {# <div style="max-width: 650px; margin: 0 auto 10px 0;">
    {% include "breast-diagram.njk" %}
  </div> #}

{% else %}
  {% set insetHtml %}
    <p>
      No breast features have been recorded for this participant.
    </p>
  {% endset %}
  {{ insetText({
    html: insetHtml
  }) }}
{% endif %}

{% set linkHref %}
  {{ "./medical-information/record-breast-features" | urlWithReferrer(currentUrl, scrollTo) }}
{% endset %}

{% if allowEdits %}
  {# <p>
    <a href="{{ linkHref | safe }}" class="nhsuk-link--no-visited-state">{{ "Add a feature" if not hasBreastFeatures else "View or edit breast features" }}</a>
  </p> #}

  <div class="nhsuk-form-group">
    {{ button({
      text: "Add a feature" if not hasBreastFeatures else "View or edit breast features",
      href: "./medical-information/record-breast-features" | urlWithReferrer(currentUrl, scrollTo),
      classes: "nhsuk-button--secondary app-button--small"
    }) }}
  </div>
{% endif %}
