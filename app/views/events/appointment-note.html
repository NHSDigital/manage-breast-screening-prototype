{# app/views/events/appointment-note.html #}

{% extends 'layout-appointment.html' %}

{% set pageHeading = "Appointment note" %}

{# Appointment note is special as for appointment view we want it at the top level with tabs, but in the worklfow we treat it as a regular form #}
{% if not isAppointmentWorkflow %}
  {% set showNavigation = true %}
  {% set referrerChain = currentUrl %}
{% endif %}

{% set activeTab = 'appointment-note' %}

{# Unlike other top level pages, we want a 2/3 grid here #}
{% set gridColumn = "nhsuk-grid-column-two-thirds" %}

{% set allowEdits = true %}

{% set formAction = eventUrl + "/appointment-note-answer" | urlWithReferrer(referrerChain) %}

{% block pageContent %}

  {# Only show H1 in workflow mode - tab view has appointment header #}
  {% if isAppointmentWorkflow %}
    <h1>{{ pageHeading }}</h1>
  {% endif %}

  {% set insetTextHtml %}
    <p>
      If adjustments are required, <a href="{{ eventUrl }}/special-appointment/edit{{ ('?referrerChain=' + referrerChain) if referrerChain }}">provide special appointment details instead</a>
    </p>
  {% endset %}

  {{ insetText({
    html: insetTextHtml
  }) }}

  {{ textarea({
    name: "[event][appointmentNote]",
    id: "appointment-note",
    label: {
      text: "Note",
      classes: "nhsuk-label--m"
    },
    hint: {
      text: "Include information that is relevant to this appointment."
    },
    value: event.appointmentNote,
    rows: 5
  }) }}

  <div class="nhsuk-button-group">
    {{ button({
      text: "Save note"
    }) }}

    {% if event.appointmentNote %}
      <a href="{{ eventUrl }}/appointment-note/delete{{ ('?referrerChain=' + referrerChain) if referrerChain }}"
        class="nhsuk-link app-link--warning"> Delete appointment note
      </a>
    {% endif %}
  </div>

{% endblock %}