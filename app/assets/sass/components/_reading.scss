@use "nhsuk-frontend/dist/nhsuk/core" as *;

// app/assets/sass/components/_reading.scss

// Todo: should this be merged with app-status-bar.scss?
// Todo: otherwise refctor so classes aren't created with &

.app-reading-status {
  padding: 10px;
  border-bottom: 1px solid #d8dde0;
  color: $nhsuk-reverse-text-colour;
  background-color: nhsuk-shade(nhsuk-colour("blue"), 40%);

  a {
    color: $nhsuk-reverse-text-colour;
  }

  &__row {
    display: flex;
    flex-wrap: wrap;
    gap: 32px;
    align-items: center;

    & + & {
      margin-top: 8px;
      padding-top: 8px;
      border-top: 1px solid rgba(255, 255, 255, 0.2);
    }
  }

  &__col {
    display: flex;
    gap: 8px;
    align-items: center;
  }

  &__participant {
    display: flex;
    flex-wrap: wrap;
    gap: 24px;
    width: 100%;
  }

  &__detail {
    display: flex;
    gap: 8px;
    align-items: center;

    strong {
      opacity: 0.9;
      font-weight: 600;
    }
  }
}

// Mammogram thumbnail grid for reading pages
.app-mammogram-thumbnails {
  display: inline-grid;
  grid-template-columns: auto auto;
  gap: 8px;
}

.app-mammogram-thumbnail--right {
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: 8px;
}

.app-mammogram-thumbnail--left {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 8px;
}

// Individual image wrapper (contains image + label)
.app-mammogram-thumbnail__image-wrapper {
  // Use flexbox for image alignment
  display: flex;

  position: relative;

  align-items: flex-start;
  // Fixed dimensions for consistent sizing
  width: 120px;
  height: 150px;

  overflow: hidden;

  background-color: #000000;
}

// Right breast images align right (inwards), left breast align left (inwards)
.app-mammogram-thumbnail--right .app-mammogram-thumbnail__image-wrapper {
  justify-content: flex-end;
}

.app-mammogram-thumbnail--left .app-mammogram-thumbnail__image-wrapper {
  justify-content: flex-start;
}

.app-mammogram-thumbnail__image {
  display: block;
  max-width: 100%;
  max-height: 100%;
  cursor: default;
}

// Slight smoothing for diagram thumbnails to reduce moir√©
.app-mammogram-thumbnail__image--diagram {
  filter: blur(0.5px);
}

.app-mammogram-thumbnail__label {
  position: absolute;
  z-index: 1;
  top: 4px;

  padding: 2px 6px;

  color: #ffffff;
  background-color: nhsuk-colour("blue");

  font-size: 11px;
  font-weight: 600;
}

// Labels align to outer edge - right breast labels on left, left breast labels on right
.app-mammogram-thumbnail--right .app-mammogram-thumbnail__label {
  left: 4px;
}

.app-mammogram-thumbnail--left .app-mammogram-thumbnail__label {
  right: 4px;
}

// Missing image placeholder
.app-mammogram-thumbnail__missing {
  box-sizing: border-box;
  display: flex;

  align-items: center;
  justify-content: center;

  width: 100%;
  height: 100%;

  border: 2px dashed nhsuk-colour("grey-2");

  background-color: nhsuk-colour("grey-5");
}

.app-mammogram-thumbnail__missing-text {
  color: nhsuk-colour("grey-2");
  font-size: 12px;
}

// Zoom overlay for thumbnails
.app-mammogram-zoom {
  display: flex;

  position: fixed;
  z-index: 9999;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;

  align-items: center;
  justify-content: center;

  background-color: rgba(0, 0, 0, 0.95);

  cursor: default;
}

.app-mammogram-zoom__image {
  max-width: 95%;
  max-height: 95%;
  object-fit: contain;
}

.app-mammogram-zoom__label {
  position: absolute;
  top: 16px;
  left: 16px;

  padding: 8px 16px;

  color: #ffffff;
  background-color: nhsuk-colour("blue");

  font-size: 14px;
  font-weight: 600;
}

// Toast message shown after giving an opinion
.app-reading-opinion-banner {
  display: flex;

  position: absolute;
  z-index: 10;
  top: 10px;

  // Manually chosen to line up with the 'previous case' link
  left: 17px;

  max-width: 720px;
  padding: nhsuk-spacing(3);

  transition: opacity 0.2s ease-out;
  // Todo: reinstate this in v11
  // border-radius: nhsuk-px-to-rem($nhsuk-button-border-radius);
  border-radius: 4px;

  opacity: 1;

  color: $nhsuk-reverse-text-colour;
  background-color: nhsuk-colour("blue");

  gap: nhsuk-spacing(3);
  filter: drop-shadow(2px 3px 3px nhsuk-tint(nhsuk-colour("black"), 50%));
}

@media (prefers-reduced-motion: reduce) {
  .app-reading-opinion-banner {
    transition: none;
  }
}

.app-reading-opinion-banner--fade-out {
  opacity: 0;
}

.app-reading-opinion-banner__text {
  margin: 0;
  color: $nhsuk-reverse-text-colour;
}

.app-reading-opinion-banner__link,
.app-reading-opinion-banner__link:visited,
.app-reading-opinion-banner__link:hover,
.app-reading-opinion-banner__link:focus {
  margin-left: nhsuk-spacing(3);
  transform: translateY(2px);
  color: $nhsuk-reverse-text-colour;
  text-decoration: underline;
  white-space: nowrap;
}

// To do: is there a better way of doing inverse links?
.app-reading-opinion-banner__link:focus,
.app-reading-opinion-banner__link:active {
  color: $nhsuk-text-colour;
}

// Reading workflow: styling for locked state
// When first arriving on a case, users should be prevented from giving an opinion for a period of time. On NBSS this is 30 seconds, but for the prototype is set to 5 seconds to avoid being annoying whilst testing.
.js-enabled {
  .app-reading-opinion--locked,
  .app-reading-opinion[data-reading-opinion-locked="true"] {
    cursor: not-allowed;

    * {
      cursor: not-allowed;
    }

    button,
    input[type="button"],
    input[type="submit"],
    input[type="radio"],
    .nhsuk-button,
    .nhsuk-radios__label,
    .nhsuk-radios__input,
    .app-button-link {
      cursor: not-allowed;
    }

    .nhsuk-button,
    .nhsuk-radios__label,
    .nhsuk-radios__input,
    button,
    input[type="button"],
    input[type="submit"] {
      pointer-events: none;
      opacity: 0.6;
    }

    .app-button-link,
    .app-button-link:hover,
    .app-button-link:focus,
    .app-button-link[aria-disabled="true"],
    .app-button-link[aria-disabled="true"]:hover,
    .app-button-link[aria-disabled="true"]:focus,
    .app-button-link[disabled],
    .app-button-link[disabled]:hover,
    .app-button-link[disabled]:focus,
    .app-button-link:disabled,
    .app-button-link:disabled:hover,
    .app-button-link:disabled:focus {
      color: nhsuk-tint($nhsuk-link-colour, 50%);
      text-decoration: underline;
    }
  }
}

// Keyboard shortcut hint styling
.app-shortcut-hint {
  opacity: 0.8;
  font-weight: 400;
}
