// app/assets/sass/components/_workflow.scss

@use "nhsuk-frontend/dist/nhsuk/core" as *;

// Wider container for workflow mode
.nhsuk-width-container--wide {
  @include nhsuk-width-container(1200px);
}

.app-workflow-mode .nhsuk-width-container {
  @include nhsuk-width-container(1200px);
}

// Use flexbox for workflow layout to allow nav column to stretch for sticky positioning
.app-workflow-container__row {
  @include nhsuk-media-query($from: desktop) {
    display: flex;
  }
}

.app-workflow-container__sidebar,
.app-workflow-container__main {
  @include nhsuk-media-query($from: desktop) {
    float: none;
  }
}

// Wrapper needs to fill the column height for sticky to work
.app-workflow-side-nav-wrapper {
  height: 100%;
}

.app-workflow-side-nav {
  position: sticky;
  top: nhsuk-spacing(4);
  padding-bottom: 15px;
}

.app-workflow-side-nav__heading {
  margin-bottom: nhsuk-spacing(3);
}

.app-workflow-side-nav__list {
  margin: 0;
  padding: 0;
  list-style: none;
}

.app-workflow-side-nav__item {
  position: relative;
  margin-left: -1px;
  border-left: 4px solid transparent;
}

.app-workflow-side-nav__link {
  @include nhsuk-font($size: 16);

  display: flex;

  position: relative;

  align-items: center;

  padding: nhsuk-spacing(2) 0 nhsuk-spacing(2) nhsuk-spacing(2);

  text-decoration: none;

  gap: nhsuk-spacing(2);
}

// Only apply link styles to actual links
// stylelint-disable-next-line selector-no-qualifying-type
a.app-workflow-side-nav__link {
  @include nhsuk-link-style-default;
  @include nhsuk-link-style-no-visited-state;

  &:hover {
    // stylelint-disable-next-line selector-no-qualifying-type
    .app-workflow-side-nav__label {
      text-decoration: underline;
      text-decoration-thickness: max(3px, 0.1875rem, 0.12em);
    }
  }

  &:focus {
    @include nhsuk-focused-text;
    color: $nhsuk-focus-text-colour;
  }
}

.app-workflow-side-nav__link--disabled {
  pointer-events: none;
  color: $nhsuk-secondary-text-colour;
  cursor: not-allowed;
}

.app-workflow-side-nav__number {
  display: flex;

  flex: 0 0 24px;
  align-items: center;
  justify-content: center;

  width: 24px;
  height: 24px;
  padding-left: 1px; // Nudge numbers slightly right

  border-radius: 50%;

  color: nhsuk-colour("grey-1");
  background-color: nhsuk-colour("grey-3");

  font-size: 14px;
  font-weight: 600;
  line-height: 1;
  text-align: center;

  .app-icon--tick {
    width: 16px;
    height: 16px;

    path {
      fill: none;
      stroke: nhsuk-colour("white");
      stroke-width: 4;
    }
  }
}

.app-workflow-side-nav__label {
  flex: 1;
}

// Item states
.app-workflow-side-nav__item--current {
  border-left-color: $nhsuk-brand-colour;

  .app-workflow-side-nav__link {
    color: $nhsuk-text-colour;
  }

  .app-workflow-side-nav__label {
    font-weight: bold;
  }

  .app-workflow-side-nav__number {
    color: nhsuk-colour("white");
    background-color: nhsuk-colour("blue");
  }
}

// Clickable links (not current, not completed, not disabled) have blue circles
.app-workflow-side-nav__link--clickable {
  .app-workflow-side-nav__number {
    color: nhsuk-colour("white");
    background-color: nhsuk-colour("blue");
  }
}

.app-workflow-side-nav__item--completed {
  .app-workflow-side-nav__link--clickable .app-workflow-side-nav__number,
  .app-workflow-side-nav__number {
    color: nhsuk-colour("white");
    background-color: nhsuk-colour("green");

    .app-icon--tick path {
      stroke: nhsuk-colour("white");
    }
  }
}

.app-workflow-side-nav__item--disabled {
  .app-workflow-side-nav__link--clickable .app-workflow-side-nav__number,
  .app-workflow-side-nav__number {
    color: nhsuk-colour("grey-1");
    background-color: nhsuk-colour("grey-4");
  }
}

// Responsive - use full width on mobile
@media (max-width: 768px) {
  .app-workflow-side-nav {
    position: static;
  }
}
